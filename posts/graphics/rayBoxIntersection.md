Title: Ray-Box Intersection
Date:  02.06.2021
Categories: Graphics
#--

*Derivation of the slab method for an axis aligned box - ray intersection.*

Demos:
====================================================================================

TL; DR:
 
2D live demo [here](../../demos/rayBoxIntersection/2D/index.html)
 
3D live demo [here](../../demos/rayBoxIntersection/3D/index.html)
 
Derivation
====================================================================================

Recall the vector equation of a line (ray)
 
$$ \vec{r} = \vec{ro} + t \vec{rd} $$
 
Such that $\vec{ro}$ is the ray origin & $\vec{rd}$ is the normalized direction of the ray
 
Written componenet-wise:
 
$$
r_x = {ro}_x + t {rd}_x
$$
$$
r_y = {ro}_y + t {rd}_y
$$
$$
r_z = {ro}_z + t {rd}_z
$$
 
A length for our ray parameter (t) can be found for each intersection with the planes generated by the vertices' positions
by equating the 1D component equations
 
<!-- ![Intersection length parameter values example](../../images/aabbRayIntersection/Aabb3.png) -->
<div id="center">
    <img src="../../images/aabbRayIntersection/Aabb3.png">
    <p>Intersection length parameter values example</p>
</div>

~~~~~~~~~~~~~~~~~~~~~~~~ C
 
float t_ax = (aBox.A[0] - aRay.ro[0]) / aRay.rd[0]
float t_ay = (aBox.A[1] - aRay.ro[1]) / aRay.rd[1]
float t_az = (aBox.A[2] - aRay.ro[2]) / aRay.rd[2]
float t_bx = (aBox.B[0] - aRay.ro[0]) / aRay.rd[0]
float t_by = (aBox.B[1] - aRay.ro[1]) / aRay.rd[1]
float t_bz = (aBox.B[2] - aRay.ro[2]) / aRay.rd[2]
~~~~~~~~~~~~~~~~~~~~~~~~
 
The key observation is to realize that there can only be an intersection if the t-intervals overlap
It's also necessary to take into account the divergent cases where the denominator $\rightarrow 0$
 
I'll save you the convoluted code I wrote to do this personally and let you play around with the visualizations
I made to convince yourself.
 
For more performant code, check out Andrew Kensler's on Peter's Shirley's raytracing tutorial.

Resources:
====================================================================================
 
* [Exhaustive list](http://www.realtimerendering.com/intersections.html) of resources for object intersections collected by the guys from real time rendering:
 
* [Peter Shirley, the man, the myth, the legend](https://raytracing.github.io/books/RayTracingTheNextWeek.html#boundingvolumehierarchies/axis-alignedboundingboxes(aabbs) ( & Andrew Kensler at Pixar)
 
* [Here](http://www.codercorner.com/RayAABB.cpp) is some old school C code from "Graphics Gems".